<% content_for :title, "–ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ç–æ - VirtualStagingAI" %>

<% content_for :head do %>
    <!-- Space Grotesk ‚Äî –Ω–∞—à —Ñ–∏—Ä–º–µ–Ω–Ω—ã–π -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --pink: #ff3b7f;
            --cyan: #00f7f6;
            --yellow: #ffe600;
            --magenta: #c724b1;
            --bg-deep: #0b0d10;
            --bg-card: #12161c;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: var(--bg-deep) !important;
            color: #ffffff !important;
        }

        .print-card {
            background: var(--bg-card);
            border: 1px solid #2a2e38;
            box-shadow: 0 20px 35px -10px rgba(0,0,0,0.8);
        }

        .btn-flash {
            background: var(--yellow);
            color: #0b0d10;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            border-radius: 2px;
            box-shadow: 6px 6px 0 var(--pink);
            transition: 0.1s linear;
            border: none;
            padding: 12px 24px;
        }
        .btn-flash:hover {
            background: #fff150;
            box-shadow: 3px 3px 0 var(--magenta);
            transform: translate(3px, 3px);
        }

        .btn-outlined {
            background: transparent;
            color: var(--cyan);
            border: 2px solid var(--cyan);
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            border-radius: 2px;
            transition: all 0.2s;
            padding: 12px 24px;
        }
        .btn-outlined:hover {
            background: rgba(0, 247, 246, 0.1);
            border-color: #00ffff;
            color: #00ffff;
            box-shadow: 0 0 12px rgba(0, 247, 246, 0.4);
        }

        .btn-danger {
            background: var(--pink);
            color: #ffffff;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            border-radius: 2px;
            transition: all 0.2s;
            padding: 12px 24px;
        }
        .btn-danger:hover {
            background: #ff1a5c;
            box-shadow: 0 0 12px rgba(255, 59, 127, 0.4);
        }

        .neon-pink {
            color: var(--pink);
            text-shadow: 0 0 8px var(--pink), 0 0 20px rgba(255, 59, 127, 0.5);
        }
        .neon-cyan {
            color: var(--cyan);
            text-shadow: 0 0 8px var(--cyan), 0 0 20px rgba(0, 247, 246, 0.4);
        }
        .neon-yellow {
            color: var(--yellow);
            text-shadow: 0 0 8px var(--yellow), 0 0 20px rgba(255, 230, 0, 0.4);
        }
    </style>
<% end %>

<div class="min-h-screen" style="background: var(--bg-deep);">
  <!-- Header -->
  <header class="print-card flex-shrink-0 flex justify-between items-center px-8 py-4 border-b border-[#ff3b7f]/30" style="background: #0f1116; border-bottom: 1px solid rgba(255,59,127,0.2);">
    <div class="flex items-center space-x-4">
      <%= link_to root_path, class: "flex items-center space-x-3" do %>
        <div class="w-8 h-8 bg-[#ffe600] rotate-12 shadow-[4px_4px_0_#ff3b7f]"></div>
        <span class="text-2xl font-black text-white tracking-tight" style="text-shadow: 2px 2px 0 #ff3b7f;">VSAI</span>
      <% end %>
      <span class="text-white/40">/</span>
      <%= link_to "–ú–û–ò –§–û–¢–û", dashboard_path, class: "text-white/80 hover:text-[#00f7f6] font-bold uppercase text-sm transition-colors" %>
    </div>
    <div class="flex items-center space-x-4">
      <%= link_to dashboard_path, class: "btn-outlined text-xs py-2 px-4" do %>
        ‚Üê –ù–ê–ó–ê–î
      <% end %>
    </div>
  </header>

  <div class="container mx-auto px-4 py-8 max-w-7xl">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
      <div class="lg:col-span-2">
        <div class="print-card p-6">
          <div class="aspect-video relative overflow-hidden bg-[#1a1d24] rounded">
            <% if @image.file.attached? %>
              <%= image_tag @image.file, class: "w-full h-full object-contain", alt: "Uploaded photo" %>
            <% else %>
              <div class="w-full h-full flex items-center justify-center text-white/40">
                <svg class="w-24 h-24 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
              </div>
            <% end %>
          </div>

          <div class="mt-6">
            <h2 class="text-2xl font-black uppercase mb-2 neon-pink">
              <%= @image.folder&.name || @image.project&.name || "–ë–ï–ó –ù–ê–ó–í–ê–ù–ò–Ø" %>
            </h2>
            <p class="text-sm text-white/60">
              –ó–∞–≥—Ä—É–∂–µ–Ω–æ <%= @image.created_at.strftime("%d %B %Y –≤ %H:%M") %>
            </p>
          </div>
        </div>
      </div>

      <!-- Sidebar —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ -->
      <div class="space-y-6">
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="print-card p-6">
          <h3 class="text-lg font-black uppercase mb-4 neon-cyan">–ò–ù–§–û–†–ú–ê–¶–ò–Ø</h3>
          <div class="space-y-4">
            <div>
              <span class="text-xs text-white/60 uppercase tracking-wider block mb-1">–ü–∞–ø–∫–∞:</span>
              <p class="text-sm font-bold text-white">
                <%= @image.folder&.name || "–ù–µ —É–∫–∞–∑–∞–Ω–∞" %>
              </p>
            </div>
            <div>
              <span class="text-xs text-white/60 uppercase tracking-wider block mb-1">–ü—Ä–æ–µ–∫—Ç:</span>
              <p class="text-sm font-bold text-white">
                <%= @image.project&.name || "–ù–µ —É–∫–∞–∑–∞–Ω" %>
              </p>
            </div>
            <div>
              <span class="text-xs text-white/60 uppercase tracking-wider block mb-1">–°—Ç–∏–ª–µ–π —Å–æ–∑–¥–∞–Ω–æ:</span>
              <p class="text-sm font-bold neon-yellow">
                <%= @image.styles_count %>
              </p>
            </div>
          </div>
        </div>

        <!-- –î–µ–π—Å—Ç–≤–∏—è -->
        <div class="print-card p-6">
          <h3 class="text-lg font-black uppercase mb-4 neon-cyan">–î–ï–ô–°–¢–í–ò–Ø</h3>
          <div class="space-y-3">
            <% if @image.deleted_at.nil? %>
              <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω–µ –≤ –∫–æ—Ä–∑–∏–Ω–µ) -->
              <%= form_with url: soft_delete_image_path(@image), method: :patch, local: true, data: { turbo: false }, class: "w-full" do |f| %>
                <%= f.submit "üóëÔ∏è –£–î–ê–õ–ò–¢–¨", 
                    class: "btn-danger w-full text-sm py-3",
                    onclick: "return confirm('–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É?');" %>
              <% end %>
            <% else %>
              <!-- –ö–Ω–æ–ø–∫–∏ –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã -->
              <%= button_to restore_image_path(@image), method: :patch,
                  class: "btn-outlined w-full text-sm py-3",
                  data: { turbo_method: :patch } do %>
                ‚Üª –í–û–°–°–¢–ê–ù–û–í–ò–¢–¨
              <% end %>
              <%= button_to image_path(@image), method: :delete,
                  class: "btn-danger w-full text-sm py-3",
                  data: { turbo_method: :delete, turbo_confirm: "–£–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å." } do %>
                ‚ö†Ô∏è –£–î–ê–õ–ò–¢–¨ –ù–ê–í–°–ï–ì–î–ê
              <% end %>
            <% end %>
          </div>
        </div>

        <!-- –°–æ–∑–¥–∞—Ç—å —Å—Ç–∏–ª—å -->
        <div class="print-card p-6">
          <h3 class="text-lg font-black uppercase mb-4 neon-cyan">–°–û–ó–î–ê–¢–¨ –°–¢–ò–õ–¨</h3>
          <p class="text-sm text-white/60 mb-4">
            –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∏–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–π–ª–∏–Ω–≥–∞
          </p>
          <%= link_to "#", class: "btn-flash w-full text-sm py-3 text-center block", data: { turbo: false } do %>
            –í–´–ë–†–ê–¢–¨ –°–¢–ò–õ–¨
          <% end %>
        </div>

        <!-- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ -->
        <% if @generations.any? %>
          <div class="print-card p-6">
            <h3 class="text-lg font-black uppercase mb-4 neon-cyan">–°–ì–ï–ù–ï–†–ò–†–û–í–ê–ù–ù–´–ï –°–¢–ò–õ–ò</h3>
            <div class="space-y-3">
              <% @generations.each do |generation| %>
                <div class="p-4 bg-[#1a1d24] border border-[#2a2e38]">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-bold text-white">
                      <%= generation.style.name %>
                    </span>
                    <span class="px-2 py-1 text-xs font-bold uppercase <%= generation.status == 'succeeded' ? 'bg-[#00f7f6]/20 text-[#00f7f6] border border-[#00f7f6]' : generation.status == 'failed' ? 'bg-[#ff3b7f]/20 text-[#ff3b7f] border border-[#ff3b7f]' : 'bg-[#ffe600]/20 text-[#ffe600] border border-[#ffe600]' %>">
                      <%= generation.status.humanize %>
                    </span>
                  </div>
                  <% if generation.output_image&.file&.attached? %>
                    <div class="block mt-2">
                      <%= image_tag generation.output_image.file, class: "w-full h-32 object-cover" %>
                    </div>
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
